<table [class.for-menu]="forMenu" class="w-full">
  <ng-container
    *tssPermission="PermissionConstant.SEE_DEPARTMENT_TEACHING_SCHEDULE"
  >
    <tr>
      <td>Lịch:</td>
      <td>
        <div class="flex gap-x-8">
          <tui-radio-labeled
            [(ngModel)]="showDepartmentSchedule"
            [item]="false"
            (ngModelChange)="onSelectingDepartmentChange($event)"
          >
            Cá nhân
          </tui-radio-labeled>
          <tui-radio-labeled
            [(ngModel)]="showDepartmentSchedule"
            [item]="true"
            (ngModelChange)="onSelectingDepartmentChange($event)"
          >
            Bộ môn
          </tui-radio-labeled>
        </div>
      </td>
    </tr>

    <tr>
      <td>
        <tui-expand [expanded]="showDepartmentSchedule">
          Giảng viên:
        </tui-expand>
      </td>
      <td>
        <tui-expand [expanded]="showDepartmentSchedule">
          <div tuiTextfieldSize="s">
            <tui-select
              [(ngModel)]="filteredTeachers"
              [valueContent]="selectTeacherTemplate"
              [tuiActiveZoneParent]="activeZone"
              (ngModelChange)="onSelectingTeachersChange($event)"
            >
              <ng-template tuiDataList>
                <tui-data-list>
                  <tui-opt-group>
                    <button tuiOption [value]="[]" size="xs">Tất cả</button>
                  </tui-opt-group>
                  <tui-opt-group
                    tuiMultiSelectGroup
                    *ngrxLet="teachers$ as teachers"
                  >
                    <button
                      tuiOption
                      *ngFor="let teacher of teachers; index as i"
                      [value]="teacher"
                      [class.!px-2]="forMenu"
                      size="xs"
                    >
                      {{ teacher.name }}
                    </button>
                  </tui-opt-group>
                </tui-data-list>
              </ng-template>
            </tui-select>
          </div>
        </tui-expand>
      </td>
    </tr>
  </ng-container>

  <tr>
    <td>Học phần:</td>
    <td>
      <div tuiTextfieldSize="s">
        <tui-select
          [(ngModel)]="filteredModules"
          [valueContent]="selectModuleTemplate"
          [tuiActiveZoneParent]="activeZone"
        >
          <ng-template tuiDataList>
            <tui-data-list>
              <tui-opt-group>
                <button tuiOption [value]="[]" size="xs">Tất cả</button>
              </tui-opt-group>
              <tui-opt-group tuiMultiSelectGroup *ngrxLet="modules$ as modules">
                <button
                  tuiOption
                  *ngFor="let module of modules; index as i"
                  [value]="module"
                  [class.!px-2]="forMenu"
                  size="xs"
                >
                  {{ module }}
                </button>
              </tui-opt-group>
            </tui-data-list>
          </ng-template>
        </tui-select>
      </div>
    </td>
  </tr>

  <tr>
    <td></td>
    <td *ngIf="!forMenu"></td>
    <td>
      <div class="flex justify-end">
        <button tuiButton (click)="onFilter()" appearance="primary" size="xs">
          Lọc
        </button>
      </div>
    </td>
  </tr>
</table>

<ng-template #selectTeacherTemplate let-teachers>
  {{
    teachers.length === 0
      ? 'Tất cả'
      : teachers.length === 1
      ? teachers[0].name
      : teachers.length + ' giảng viên'
  }}
</ng-template>

<ng-template #selectModuleTemplate let-modules>
  {{
    modules.length === 0
      ? 'Tất cả'
      : modules.length === 1
      ? modules[0]
      : modules.length + ' học phần'
  }}
</ng-template>
